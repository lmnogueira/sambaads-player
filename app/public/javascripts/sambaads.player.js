"use strict";var SambaAdsPlayerControler={};SambaAdsPlayerControler=function(t,e,i){var a=this;window.sambaads={},window.sambaads.parentIframeID="",a.player=t,a.guid=encodeURIComponent(this.guid()),a.view=e,a.currentMediaId="",a.currentPlaylistIndex=0,a.lastPlaylistIndex=0,a.newstate="IDLE",a.oldstate=null,a.startNextIn=null,a.pertmitWidthAutoStart=320,a.firstPlay=!0,this.view.setController(this),void 0==i||null==i||a.init(i)},SambaAdsPlayerControler.prototype.discoveryHost=function(){var t=document.referrer||window.location.href;return t},SambaAdsPlayerControler.prototype.sendMessage=function(t,e){window.parent.postMessage(window.sambaads.parentIframeID+"::"+t+"::"+e,"*")},SambaAdsPlayerControler.prototype.guid=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},SambaAdsPlayerControler.prototype.sendGif=function(t){var e=document.referrer||window.location.href,i=$("<a>",{href:e})[0];t.satmref=i.hostname,t.satmfullref=e,$.get("//player.sambaads.com/api/v1/collector/satm.gif",t).done(function(t){}).error(function(){})},SambaAdsPlayerControler.prototype.getEnvironment=function(){return this.response.player_info.environment},SambaAdsPlayerControler.prototype.updateViewsCount=function(t,e,i){this.currentMediaId!=t&&(this.currentMediaId=t,this.sendGif({satms:this.guid,satmtag:"media.play",satmpid:this.response.publisher_info.hash_code,satmoid:e,satmmid:t,satmcid:i,satmref:"",satmfullref:"",satmenv:this.getEnvironment()}))},SambaAdsPlayerControler.prototype.updateLoadCount=function(t,e){this.sendGif({satms:this.guid,satmtag:"media.load",satmpid:this.response.publisher_info.hash_code,satmoid:t,satmcid:e,satmref:"",satmfullref:"",satmenv:this.getEnvironment()})},SambaAdsPlayerControler.prototype.onMessageReceive=function(t){var e=t.data.split("::"),i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;"play"==e[1]&&this.response.publisher_info.auto_start&&i>this.pertmitWidthAutoStart&&(this.play(),this.view.updateItemCurrent()),"pause"==e[1]&&this.response.publisher_info.auto_start&&i>this.pertmitWidthAutoStart&&this.pause(),"mute"==e[1]&&this.setMute(e[2]),"ready"==e[1]&&(window.sambaads.parentIframeID=e[0],this.sendMessage("ready",this.response.publisher_info.auto_start+","+this.calculatePlayerWidth()+","+this.calculatePlayerHeight()),this.sendMessage("onNowWatchTitle",this.getCurrentVideo().title)),"debug"==e[1],"seek"==e[1]&&this.seekTo(e[2]),"visible"==e[1]&&("true"===e[2]?this.response.publisher_info.auto_start?("PLAYING"!=this.newstate?(i>this.pertmitWidthAutoStart&&(this.play(),this.view.updateItemCurrent()),this.setMute(!1)):this.setMute(!1),this.firstPlay&&(this.firstPlay=!1,i>this.pertmitWidthAutoStart&&this.setMute(!0))):this.setMute(!1):(this.setMute(!0),"PLAYING"==this.newstate&&i>this.pertmitWidthAutoStart&&this.pause())),"mouseover"==e[1]&&"IDLE"!=this.newstate&&this.setMute(!1),"expandedCinema"==e[1]&&"clickThrough"==e[2]&&window.sambaads.expandedCinema.getSwf(window.sambaads.expandedCinema.objectID).sendEvent("clickThrough")},SambaAdsPlayerControler.prototype.initilizeSmbMessanger=function(){var t=this;window.onMessageReceive=function(e){t.onMessageReceive(e)},window.addEventListener?window.addEventListener("message",window.onMessageReceive,!1):attachEvent("onmessage",window.onMessageReceive)},SambaAdsPlayerControler.prototype.discoveryPlaylistInfo=function(){var t={};return $(document).height()>=$(document).width()?(t.plp="bottom-vertical",t.tm="dark"):(t.plp="right",t.tm="dark"),t},SambaAdsPlayerControler.prototype.init=function(t){var e=this;this.response=t,e.updateLoadCount("",this.response.player_info.category_name),this._options={position:this.response.player_info.playlist_position||e.discoveryPlaylistInfo().plp,playlistStyle:this.response.player_info.theme||e.discoveryPlaylistInfo().tm,playlist:[]},"right"==this._options.position&&(this._options.playlistHeight=0,this._options.playlistWidth=this.response.player_info.playlist_width||280),"bottom-vertical"==this._options.position&&(this._options.playlistHeight=this.response.player_info.playlist_height||150,this._options.playlistWidth=0),"bottom-horizontal"==this._options.position&&(this._options.playlistWidth=0,this._options.playlistHeight=143),this._options.playlist=this.response.playlist;var i=this.calculatePlayerWidth(),a=this.calculatePlayerHeight(),o={color:"#FFFFFF",fontSize:12,fontFamily:"verdana-bold, verdana",fontOpacity:100,backgroundColor:"#000000",backgroundOpacity:0,edgeStyle:"dropshadow",windowColor:"#000000",windowOpacity:0},s={displaytitle:!1,advertising:{client:"vast",tag:decodeURIComponent(this.response.player_info.custom_tag)},plugins:{"https://cdn-static-secure.liverail.com/js/LiveRail.AdManager.JWPlayer-6.8.1.plugin.js":{LR_ADMAP:"in::0",LR_URL:this.discoveryHost(),LR_TAGS:this.response.publisher_info.auto_start?"autostart":"normal"}},playlist:this._options.playlist,skin:"http:"+this.response.player_info.skin_url,width:i,height:a,captions:o,primary:"flash",abouttext:"SambaAds - no cats playing piano.",aboutlink:"http://www.sambaads.com.br/publishers"};this.response.player_info.custom_tag?delete s.plugins:delete s.advertising,window.jwplayer(this.player).setup(s),window.jwplayer(e.player).onReady(function(){smb.init(e.player,e._options),e.onLoad()}),window.jwplayer(e.player).onFullscreen(function(t){smb.onFullscreen(t)}),window.jwplayer(e.player).onPlay(function(t){e.response.publisher_info.auto_start=!0,e.computeComscore("04","sambaads_content"),window.jwplayer(e.player).setControls(!0),smb.onPlay(),e.oldstate=e.newstate,e.newstate=t.newstate,e.sendMessage("onStateChange",t.newstate)}),window.jwplayer(e.player).onMute(function(t){}),window.jwplayer(e.player).onPause(function(t){smb.fullscreenActive?window.jwplayer(e.player).setControls(!0):window.jwplayer(e.player).getPosition()>1?(smb.showDisplay("play"),window.jwplayer(e.player).setControls(!1)):smb.showDisplay("buffer"),e.oldstate=e.newstate,e.newstate=t.newstate,e.sendMessage("onStateChange",t.newstate)}),window.jwplayer(e.player).onBuffer(function(t){e.oldstate=e.newstate,e.newstate=t.newstate,smb.showDisplay("buffer")}),window.jwplayer(e.player).onIdle(function(t){smb.hideDisplay(),e.oldstate=e.newstate,e.newstate=t.newstate}),window.jwplayer(e.player).onTime(function(t){smb.hideDisplay()}),window.jwplayer(e.player).onBeforeComplete(function(t){e.oldstate=e.newstate,e.newstate=t.newstate}),window.jwplayer(e.player).onComplete(function(t){smb.onComplete(),e.stop(),e.newstate="IDLE",e.oldstate="PLAYING"}),window.jwplayer(e.player).onAdTime(function(t){smb.hideDisplay()}),window.jwplayer(e.player).onAdError(function(t){smb.hideDisplay()}),window.jwplayer(e.player).onAdImpression(function(t){smb.hideDisplay()}),window.jwplayer(e.player).onAdComplete(function(t){}),window.jwplayer(e.player).onBeforePlay(function(t){smb.hideDisplay()})},SambaAdsPlayerControler.prototype.onLoad=function(){this.computeComscore("04","sambaads_content"),this.computeComscore("01","sambaads_video_advertising"),this.initilizeSmbMessanger()},SambaAdsPlayerControler.prototype.getCurrentVideo=function(){return window.jwplayer(this.player).getPlaylistItem(window.jwplayer(this.player).getPlaylistIndex())},SambaAdsPlayerControler.prototype.computeComscore=function(t,e){COMSCORE.beacon({c1:1,c2:"15752844",c3:e,c4:"",c5:t,c6:"",c10:""})},SambaAdsPlayerControler.prototype.calculatePlayerHeight=function(){var t=0;return t=$("#titlebar").is(":visible")?$(document).height()-$("#titlebar").outerHeight():$(document).height(),this._options.playlist.length>1&&(t-=this._options.playlistHeight),t},SambaAdsPlayerControler.prototype.calculatePlayerWidth=function(){var t=0;return t=$(document).width(),this._options.playlist.length>1&&(t-=this._options.playlistWidth),t},SambaAdsPlayerControler.prototype.getPlaylist=function(){return this._options.playlist},SambaAdsPlayerControler.prototype.loadPlaylist=function(t){this.currentPlaylistIndex!=t&&(this.stop(),this.lastPlaylistIndex=this.currentPlaylistIndex,this.currentPlaylistIndex=t,this._options.playlist[t].running_youtube=!1,window.jwplayer(this.player).load([this._options.playlist[t]])),this.view.videoTitle.innerHTML=this._options.playlist[t].title},SambaAdsPlayerControler.prototype.setMute=function(t){"boolean"==typeof Boolean(t)&&window.jwplayer(this.player).setMute(t)},SambaAdsPlayerControler.prototype.play=function(){window.jwplayer(this.player).play(),window.jwplayer(this.player).callInternal("jwCallVPAID","pauseAd")},SambaAdsPlayerControler.prototype.pause=function(){window.jwplayer(this.player).pause(),window.jwplayer(this.player).callInternal("jwCallVPAID","pauseAd")},SambaAdsPlayerControler.prototype.seekTo=function(t){window.jwplayer(this.player).seek(t)},SambaAdsPlayerControler.prototype.stop=function(){window.jwplayer(this.player).stop()},SambaAdsPlayerControler.prototype.playNext=function(){this.loadPlaylist(this.currentPlaylistIndex+1),window.jwplayer(this.player).play()};var SambaAdsPlayerView={};SambaAdsPlayerView=function(){this.debug=!0,this.displayOverlayShare=document.getElementById("display-overlay-share"),this.displayOverlayPlay=document.getElementById("display-overlay-play"),this.displayOverlayNextVideo=document.getElementById("display-overlay-next"),this.playButtom=document.getElementById("display-buttom-play"),this.videoTitleBar=document.getElementById("video-title-bar"),this.videoTitle=document.getElementById("video-title")},SambaAdsPlayerView.prototype.showDisplay=function(t){var e=window.jwplayer(self.player).getWidth()+"px",i=window.jwplayer(self.player).getHeight()+"px";if($("#share-button-dock").hide(),this.currentDisplay=t,this.displayOverlayPlay.style.display="none",$("#display-overlay-loader").hide(),this.displayOverlayShare.style.display="none",this.displayOverlayNextVideo.style.display="none","play"==t)this.displayOverlayPlay.style.display="block",$("#video-title").show(),$("#video-title").text(this.controller.getCurrentVideo().title),this.setShareFacebookUrl("https://app.sambaads.com/api/sharer?mid="+this.controller.getCurrentVideo().media_id+"&pid="+this.controller.response.publisher_info.hash_code+"&t="+this.controller.getCurrentVideo().title),this.setShareEmbed('<script src="//player.sambaads.com/embed/player.js?m='+this.controller.getCurrentVideo().media_id+"&p="+this.controller.response.publisher_info.hash_code+'&sk=blue&tm=light&plp=&plw=&plh=&w=640&h=360"></script>');else if("buffer"==t)$("#display-overlay-loader").show();else if("share"==t){var a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;o>a&&320>=a&&($(".wrapper-share").css("top","10%"),$(".close-button").css("z-index","101"),$("#btn-select-embed").css("margin-top","10px")),this.displayOverlayShare.style.display="block"}else"next-video"==t&&(this.displayOverlayNextVideo.style.display="block");$("#display-overlay").width(e),$("#display-overlay").height(i)},SambaAdsPlayerView.prototype.init=function(t,e){var i=this;i.player=t,i.options=e,i.showDisplay("play"),e.playlist.length>1&&i.showPlaylist(e),$("#display-overlay-loader").hide(),$("#display-buttom-play").click(function(){i.controller.play(),i.updateItemCurrent()}),document.getElementById("share-button-dock").onclick=function(){i.controller.shareLastState=i.controller.newstate,i.controller.play(),i.showDisplay("share"),$("#share-button-dock").hide()},document.getElementById("share-button").onclick=function(){i.controller.shareLastState=i.controller.newstate,i.showDisplay("share")},document.getElementById("close-button").onclick=function(){i.showDisplay("play"),"PLAYING"==i.shareLastState&&i.controller.play()},document.getElementById("next-counter").onclick=function(){clearInterval(i.controller.startNextIn),i.controller.playNext(),i.updateItemCurrent()},document.getElementById("replay-button").onclick=function(){clearInterval(i.controller.startNextIn),window.jwplayer(i.player).play()},document.getElementById("btn-select-embed").onclick=function(){var t=document.getElementById("share-embed");t.select(),t.focus(),$("#btn-select-embed").text("ctrl + c para copiar"),setTimeout(function(){$("#btn-select-embed").text("selecionar embed")},2e3)},$("div.sambaads-embed").mousemove(function(t){$("#share-button-dock").css("top",$("div.sambaads-embed").offset().top+11+"px"),$("#share-button-dock").css("right",$(window).width()-$("div.sambaads-embed").width()+11+"px"),$("#share-button-dock").css("z-index","2"),"IDLE"!=i.controller.newstate&&"PAUSED"!=i.controller.newstate&&"share"!=i.currentDisplay&&$("#share-button-dock").show()}).mouseleave(function(t){$("#share-button-dock").hide()}),$("#share-button-dock").mousemove(function(t){$("#share-button-dock").css("top",$("div.sambaads-embed").offset().top+10+"px"),$("#share-button-dock").css("right",$(window).width()-$("div.sambaads-embed").width()+10+"px"),$("#share-button-dock").css("z-index","2"),"IDLE"!=i.controller.newstate&&"PAUSED"!=i.controller.newstate&&"share"!=i.currentDisplay&&$("#share-button-dock").show()}).mouseleave(function(t){$("#share-button-dock").hide()})},SambaAdsPlayerView.prototype.playVideo=function(t){this.playerSetup.playlist=[t],window.jwplayer(self.player).setup(this.playerSetup),this.init(self.player)},SambaAdsPlayerView.prototype.hideDisplay=function(){$("#display-overlay-loader").hide(),this.displayOverlayPlay.style.display="none",this.displayOverlayShare.style.display="none",this.displayOverlayNextVideo.style.display="none"},SambaAdsPlayerView.prototype.setTitleBar=function(t,e){$("#titlebar").css("backgroundColor",e),0==t.length?$("#titlebar").hide():$("#titlebar-title").text(decodeURIComponent(t))},SambaAdsPlayerView.prototype.setShareLink=function(t){var e=document.getElementById("share-link");e&&(e.value=t)},SambaAdsPlayerView.prototype.setShareEmbed=function(t){var e=document.getElementById("share-embed");e&&(e.value=t)},SambaAdsPlayerView.prototype.setShareFacebookUrl=function(t){var e=document.getElementById("facebook-url-share");e.href="https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(t)},SambaAdsPlayerView.prototype.setController=function(t){this.controller=t},SambaAdsPlayerView.prototype.log=function(t){},SambaAdsPlayerView.prototype.updateItemCurrent=function(){var t=this;$("div.playlist-item").each(function(e,i){i.id.indexOf(t.controller.currentPlaylistIndex)>=0&&($(i).find("span.video-duration").text("ASSISTINDO"),$(i).find("span.video-duration").show()),i.id.indexOf(t.controller.lastPlaylistIndex)>=0&&t.controller.lastPlaylistIndex!=t.controller.currentPlaylistIndex&&$(i).find("span.video-duration").hide()})},SambaAdsPlayerView.prototype.showPlaylist=function(t){var e=this;e.vitem=$("#playlist-v-item"),e.hitem=$("#playlist-h-item"),$("#playlist-v-items").empty(),$("#playlist-h-items").empty(),"right"==t.position?($($.find("div.sambaads-playlist.vertical")[0]).addClass(t.playlistStyle),$("#playlist-h-items").hide(),$("#sambaads-embed").addClass("pull-left"),$(".nano").css("height",window.jwplayer(e.player).getHeight())):"bottom-vertical"==t.position?($($.find("div.sambaads-playlist.vertical")[0]).addClass(t.playlistStyle),$("#playlist-h-items").hide(),$("#playlist-v-items").show(),$(".nano").css("height",t.playlistHeight)):"bottom-horizontal"==t.position&&($($.find("div.sambaads-playlist.horizontal")[0]).addClass(t.playlistStyle),$("#playlist-h-items").show()),this.controller.getPlaylist().forEach(function(t){var i=e.vitem.clone(),a=e.hitem.clone();i.attr("id","v-"+$("#playlist-v-items").children().length),a.find("div.playlist-item").attr("id","h-"+$("#playlist-h-items").children().length),$(i).find("img").attr("src",t.image),$(a).find("img").attr("src",t.image),$(i).find("div.video-description h4 a").text(t.title.replace(/^(.{30}[^\s]*).*/,"$1")+"\n"),$(a).find("div.video-description h4 a").text(t.title.replace(/^(.{30}[^\s]*).*/,"$1")+"\n"),$("#playlist-v-items").append(i),$("#playlist-h-items").append(a)}),$(".sambaads-playlist").show(),$("#playlist-h-items").lightSlider({item:3,autoWidth:!0,slideMove:1,slideMargin:0,mode:"slide",useCSS:!0,loop:!0,controls:!0,prevHtml:'<i class="icon-previous"></i>',nextHtml:'<i class="icon-next"></i>',pager:!1,enableTouch:!1,enableDrag:!1,onSliderLoad:function(){$("#autoWidth").removeClass("cS-hidden")}}),$(".nano").nanoScroller(),$("div.playlist-item").click(function(){var t=this.id.split("-")[1];e.controller.loadPlaylist(+t),e.controller.play(),e.updateItemCurrent()})},SambaAdsPlayerView.prototype.onPlay=function(){this.hideDisplay(),this.controller.updateViewsCount(this.options.playlist[this.controller.currentPlaylistIndex].media_id,this.options.playlist[this.controller.currentPlaylistIndex].owner_id,this.options.playlist[this.controller.currentPlaylistIndex].category_name),this.options.playlist[this.controller.currentPlaylistIndex+1]&&($("#video-next-title").text(this.options.playlist[this.controller.currentPlaylistIndex+1].title),$("#video-next-thumbnail").attr("src",this.options.playlist[this.controller.currentPlaylistIndex+1].image))},SambaAdsPlayerView.prototype.onFullscreen=function(t){var e=window.jwplayer(this.controller.player).getWidth()+"px",i=window.jwplayer(this.controller.player).getHeight()+"px";t.fullscreen?this.fullscreenActive=!0:(this.fullscreenActive=!1,$("#display-overlay").width(e),$("#display-overlay").height(i))},SambaAdsPlayerView.prototype.onComplete=function(){var t=this,e=10;t.controller.currentPlaylistIndex+1<t.options.playlist.length?(t.showDisplay("next-video"),$(".progress-circle").circleProgress({value:1,size:36,lineCap:"round",thickness:2,emptyFill:"rgba(255, 255, 255, 0.1)",animation:{duration:12e3},fill:{color:"#fff"}}),$("#counter-down").text(e),t.startNextIn=setInterval(function(){$("#counter-down").text(e),0==e&&(t.hideDisplay(),t.controller.playNext(),clearInterval(t.startNextIn),t.updateItemCurrent()),e--},1e3)):t.showDisplay("play")};
//# sourceMappingURL=sambaads.player.js.map