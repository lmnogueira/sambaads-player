{"version":3,"sources":["widget.js"],"names":["cw","detectScript","currentScript","document","scripts","getElementsByTagName","length","src","indexOf","currentIframe","location","sambaads","players","getPlayer","iframeId","i","id","parseQueryString","url","queries","temp","l","queryString","split","params","e","serialize","obj","str","p","hasOwnProperty","push","encodeURIComponent","join","insertAfter","referenceNode","newNode","parentElement","insertBefore","nextSibling","appendIframe","parameters","div","createElement","iframe_id","iframe_url","width_height","rfr","window","href","request_domain","w","h","innerHTML","firstChild","iframe_data","pid","mid","m","cid","c","plw","plh","dimension","d","width","height","iframe_target_host","protocol","toClearTimeout","isReady","contentWindow","getElementById","this","sendMessage","smbevent","data","postMessage","init","debug","crossMessageInitialization","onMessageReceive","event","origin","clearInterval","player_width","player_height","initializePluginsAfeterReady","console","log","addEventListener","attachEvent","setInterval"],"mappings":"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","file":"widget.js","sourcesContent":["'use strict';\n\n(function(cw){ \n\n\tvar detectScript = function(){\n\t\tvar currentScript = document.currentScript || (function() {\n      \t\tvar scripts = document.getElementsByTagName('script');\n\n      \t\tif(scripts[scripts.length - 1].src.indexOf(\"widget.sambaads.com\") != 0)\n      \t\t\treturn scripts[scripts.length - 1];\n    \t})();\n\n    \treturn currentScript;\n\t}\n\n\t//initialize with client window\n\tvar currentScript = detectScript();\n\tvar currentLocation = cw.location;\n\tvar currentIframe = {}\n\t\n\tif(!cw.sambaads){ \n\t\tcw.sambaads = {};\n\t\tcw.sambaads.players = []\n\n\t\tcw.sambaads.getPlayer = function(iframeId){\n\n\t\t\tiframeId = iframeId || \"sambaads_0\";\n\n\t\t\tfor (var i = 0; i < cw.sambaads.players.length; i++) { \n\t\t\t\tif(cw.sambaads.players[i].id == iframeId){\n\t\t\t\t\treturn cw.sambaads.players[i];\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t};\n\n\t//parse querystring paramenters from url\n\tvar parseQueryString = function( url ) {\n\n\t\tvar queryString = url.split(\"?\")[1];\n\t\tvar params = {}, queries, temp, i, l;\n\n\t\t// Split into key/value pairs\n\t\ttry{\n\t\t\tqueries = queryString.split(\"&\");\n\n\t\t\t// Convert the array of strings into an object\n\t\t\tfor ( i = 0, l = queries.length; i < l; i++ ) {\n\t\t\t\ttemp = queries[i].split('=');\n\t\t\t\tparams[temp[0]] = temp[1];\n\t\t\t}\n\t\t} catch (e){\n\t\t\t//console.log(e);\n\t\t}\n\n\t\treturn params;\n\t};\n\n\tvar serialize = function(obj) {\n\t  \tvar str = [];\n\t  \tfor(var p in obj){\n\t    \tif (obj.hasOwnProperty(p)) {\n\t      \t\tstr.push(encodeURIComponent(p) + \"=\" + (obj[p] || \"\"));\n\t    \t}\n\t\t}\n\t  \treturn str.join(\"&\");\n\t}\n\n\tvar insertAfter = function (referenceNode, newNode) {\n    \treferenceNode.parentElement.insertBefore(newNode, referenceNode.nextSibling);\n    \t//referenceNode.parentElement.removeChild(referenceNode);\n\t};\n\n\tvar appendIframe = function(parameters){\n\t\tvar div = document.createElement('div');\n\t\tvar iframe_id = \"sambaads_\" + cw.sambaads.players.length;\n\t\tvar iframe_url = \"\";\n\t\tvar width_height = \"\";\n\n\t\t// parameters.m = parameters.m || parameters.mid || \"\";\n\t\t// parameters.p = parameters.p || parameters.pid || \"\";\n\t\t// parameters.c = parameters.c || parameters.cid || \"\";\n\t\t// parameters.t = parameters.t || \"\";\n\t\t// parameters.sk = parameters.sk || \"\";\n\t\t// parameters.tm = parameters.tm || \"\";\n\t\t// parameters.plp = parameters.plp || \"\";\n\t\t// parameters.plw = parameters.plw || \"\";\n\t\t// parameters.plh = parameters.plh || \"\";\n\t\t// parameters.ct = parameters.ct || \"\";\n\t\t// parameters.tb = parameters.tb || \"\";\n\t\t// parameters.tbbg = parameters.tbbg || \"\";\n\t\t// parameters.tbfs = parameters.tbfs || \"\";\n\t\tparameters.rfr = encodeURIComponent(window.location.href);\n\t\t//parameters.rfr = encodeURIComponent(\"http://vimh.co/2015/03/entendendo-marketing-de-uma-forma-inesquecivel\")\n\n\n\t\t//se não conseguir obter ao menos o publisher ID não deve renderizar o iframe\n\t\tif(!parameters.p)\n\t\t\treturn;\n\t\t\n\t\tiframe_url = \"//\" + parameters.request_domain + \"/widget/\" + parameters.p + \"?\" + serialize(parameters);\n\n\t\t// if (parameters.m){\n\t\t// \tiframe_url = iframe_url +\n\t\t// \t\t\"m=\" + parameters.m +\n\t\t// \t\t\"&t=\" + parameters.t +\n\t\t// \t\t\"&sk=\" + parameters.sk +\n\t\t// \t\t\"&tm=\" + parameters.tm +\n\t\t// \t\t\"&plp=\" + parameters.plp +\n\t\t// \t\t\"&plw=\" + parameters.plw +\n\t\t// \t\t\"&plh=\" + parameters.plh +\n\t\t// \t\t\"&ct=\" + parameters.ct +\n\t\t// \t\t\"&tb=\" + encodeURIComponent(parameters.tb) +\n\t\t// \t\t\"&tbbg=\" + parameters.tbbg +\n\t\t// \t\t\"&tbfs=\" + parameters.tbfs +\n\t\t// \t\t\"&rfr=\" + parameters.rfr\n\t\t// } else {\n\t\t// \tiframe_url = iframe_url +\n\t\t// \t\"c=\" + parameters.c +\n\t\t// \t\"&t=\" + parameters.t +\n\t\t// \t\"&sk=\" + parameters.sk +\n\t\t// \t\"&tm=\" + parameters.tm +\n\t\t// \t\"&plp=\" + parameters.plp +\n\t\t// \t\"&plw=\" + parameters.plw +\n\t\t// \t\"&plh=\" + parameters.plh +\n\t\t// \t\"&ct=\" + parameters.ct +\n\t\t// \t\"&tb=\" + encodeURIComponent(parameters.tb) +\n\t\t// \t\"&tbbg=\" + parameters.tbbg +\n\t\t// \t\"&tbfs=\" + parameters.tbfs +\n\t\t// \t\"&rfr=\" + parameters.rfr\n\t\t// }\n\n\t\tif(parameters.w){\n\t\t\twidth_height = \"width=\\\"\" + parameters.w + \"\\\" \";\n\t\t}\n\n\t\tif(parameters.h){\n\t\t\twidth_height = width_height + \"height=\\\"\" + parameters.h + \"\\\" \";\n\t\t}\n\n\t\t//generate iframe embed\n\t\t// if(parameters.m || parameters.c){\n\t\t\tdiv.innerHTML = \"<iframe id=\\\"\" + iframe_id + \"\\\" \" + width_height + \"src=\\\"\" + iframe_url + \"\\\" frameborder=\\\"0\\\" scrolling=\\\"no\\\"  webkitallowfullscreen mozallowfullscreen allowFullScreen></iframe>\";\n\t\t// } else {\n\t\t\t// div.innerHTML = \"<div id='sambaads_now_whatch_div' class='sambaads_now_whatch_div'><div style='margin-bottom: 10px;text-align: -webkit-left; text-align: left;'><h2 id='sambaads_now_whatch' class='sambaads_now_whatch' style='margin-top:10px;margin-bottom:10px; width: auto; font-family: verdana, arial, sans-serif;display: inline-block; margin-right: 5px; color:#000000; font-weight: bold; font-size:1.5em;'>ASSISTA AGORA:</h2><span id='sambaads_now_whatch_title_\" + iframe_id + \"' class='sambaads_now_whatch_title' style='font-family: verdana, arial, sans-serif; color:#126cb0;font-size:1.1em; font-weight: bold;'></span></div><iframe id=\\\"\" + iframe_id + \"\\\" \" + width_height + \"src=\\\"\" + iframe_url + \"\\\" frameborder=\\\"0\\\" scrolling=\\\"no\\\"  webkitallowfullscreen mozallowfullscreen allowFullScreen></iframe><div style='height: 30px;'><p style=\\\"font-size: 11px; margin: 0px; color: #B0B0B0; text-align: left; text-align: -webkit-left;\\\">powered by <a href=\\\"//www.sambaads.com.br/?utm_campaign=Recomendador&utm_medium=Powered&utm_source=PlayerRecomendador\\\"><img src='//d366amxgkdfvcq.cloudfront.net/images/sambaads-logo.png' style='vertical-align:middle; width:100px !important; height: 24px !important'></a></p></div></div>\";\n\t\t// }\n\n\t\t//Put iframe after de <script> tag\n\t\tinsertAfter(currentScript, div.firstChild);\n\n\t\tvar iframe_data = {\n\t\t\tid : iframe_id,\n\t\t\tpid : parameters.p || parameters.pid || \"\",\n\t\t\tmid : parameters.m || parameters.mid || \"\",\n\t\t\tcid : parameters.c || parameters.cid || \"\",\n\t\t\tplw : parameters.plw || 0,\n\t\t\tplh : parameters.plh || 0,\n\t\t\tdimension : parameters.d || parameters.dimension,\n\t\t\twidth: parameters.w,\n\t\t\theight: parameters.h,\n\t\t\tiframe_target_host: cw.location.protocol + \"//\" + parameters.request_domain,\n\t\t\ttoClearTimeout: 0,\n\t\t\tisReady: false,\n\t\t\tcontentWindow: function(){\n\t\t\t\treturn document.getElementById(this.id).contentWindow;\n\t\t\t},\n\t\t\tsendMessage: function(smbevent,data){\n\t\t\t\tif(this.contentWindow().postMessage){\n\t\t\t\t\tthis.contentWindow().postMessage( this.id + \"::\" + smbevent + \"::\" + data, this.iframe_target_host )\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t//get the iframeId controled by this script\n\t\tcurrentIframe = iframe_data;\n\n\t\t//store all player embeded on the same page\n\t\tcw.sambaads.players.push(iframe_data);\n\n\t\treturn iframe_data;\n\t};\n\n\tvar init = function(){\t\t\n\t\t//parser = new DOMParser()\n\t\t//console.log(\"Initializing SambaAds JS Player!\");\n\n\n\t\t//initialize parameters\n\t\tvar parameters = parseQueryString(currentScript.src);\t\n\n\t\tparameters.w = parameters.w ? parameters.w : \"100%\";\n\t\tparameters.h = parameters.h ? parameters.h : \"100%\";\n\t\tparameters.request_domain = parameters.debug == \"true\" ? \"192.168.33.10:3000\" : \"d366amxgkdfvcq.cloudfront.net\";\n\n\t\t//append the iframe player\n\t\tvar iframe_data = appendIframe(parameters);\n\n\t\t//initializing the crossdomain message support\n\t\tcrossMessageInitialization(iframe_data);\n\t};\n\n\tvar onMessageReceive = function(event){\n\t\tif(event.origin.indexOf(\"cloudfront\") >= 0 || event.origin.indexOf(\"192.168.33.10:3000\") >= 0){\n\n\t\t\tvar params = event.data.split(\"::\");\n\n\t\t\tif(params[0] == currentIframe.id){\n\t\t\t\t//console.log(\"CORE RECEIVED:\" + event.data)\n\n\t\t\t\tif (params[1] == \"ready\" ){\n\t\t  \t\t\tclearInterval(currentIframe.isReady);\n\t\t  \t\t\tcurrentIframe.isReady = true;\n\t\t  \t\t\tcurrentIframe.player_width = params[2].split(\",\")[1];\n\t\t  \t\t\tcurrentIframe.player_height = params[2].split(\",\")[2] - 4; //- 4 pixels ajust\n\t\t  \t\t\tinitializePluginsAfeterReady();\n\t\t \t\t}\n\n\t\t \t\tif (params[1] == \"click\" ){\n\t\t \t\t\tconsole.log(\"implementar click video modal\")\n\t\t \t\t}\n\n\t\t\t}\n\t\t}\n\t};\n\n\tvar crossMessageInitialization = function(){\n\t\tif (cw.addEventListener){\n\t\t\tcw.addEventListener(\"message\", onMessageReceive, false)\n\t\t} else {\n\t\t\tattachEvent(\"onmessage\", onMessageReceive)\n\t\t};\n\t\t\n\t\tcurrentIframe.isReady = setInterval(function(){\n\t\t\tcurrentIframe.sendMessage(\"ready\",\"\")\n\t\t},2000)\n\t}\n\n\tinit();\n})(this);"],"sourceRoot":"/source/"}