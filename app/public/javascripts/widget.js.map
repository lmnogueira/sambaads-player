{"version":3,"sources":["widget.js","modal.js"],"names":["cw","SambaadsModal","detectScript","currentScript","document","scripts","getElementsByTagName","length","src","indexOf","currentIframe","location","sambaads","players","getPlayer","iframeId","i","id","parseQueryString","url","queries","temp","l","queryString","split","params","e","serialize","obj","str","p","hasOwnProperty","push","encodeURIComponent","join","insertAfter","referenceNode","newNode","parentElement","insertBefore","nextSibling","appendIframe","parameters","div","createElement","iframe_id","iframe_url","width_height","rfr","window","href","request_domain","w","h","innerHTML","firstChild","iframe_data","pid","mid","m","cid","c","plw","plh","dimension","d","width","height","iframe_target_host","protocol","toClearTimeout","isReady","contentWindow","getElementById","this","sendMessage","smbevent","data","postMessage","init","crossMessageInitialization","onMessageReceive","event","origin","clearInterval","player_width","player_height","initializePluginsAfeterReady","modal","open","JSON","parse","addEventListener","attachEvent","setInterval","prototype","createElementPlayer","arguments","getElementsByClassName","divMaster","innerWidth","documentElement","clientWidth","body","innerHeight","clientHeight","style","position","appendChild","divChildren","backgroundColor","padding","divScript","script","type","mediaId","publisherId","divContext","divTitle","textContent","title","fontSize","color","fontFamily","fontWeight","textAlign","margin","divDescription","description","divTags","tagList","top","left","defineStylePage","className","right","bottom","zIndex","overflow","createListeners","close","removeChild","element","self","onclick"],"mappings":"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","file":"widget.js","sourcesContent":["\n\tvar detectScript = function(){\n\t\tvar currentScript = document.currentScript || (function() {\n      \t\tvar scripts = document.getElementsByTagName('script');\n\n      \t\tif(scripts[scripts.length - 1].src.indexOf('/* @echo WIDGET_DOMAIN */') != 0)\n      \t\t\treturn scripts[scripts.length - 1];\n    \t})();\n\n    \treturn currentScript;\n\t}\n\n\t//initialize with client window\n\tvar currentScript = detectScript();\n\tvar currentLocation = cw.location;\n\tvar currentIframe = {}\n\t\n\tif(!cw.sambaads){ \n\t\tcw.sambaads = {};\n\t\tcw.sambaads.players = []\n\n\t\tcw.sambaads.getPlayer = function(iframeId){\n\n\t\t\tiframeId = iframeId || \"sambaads_0\";\n\n\t\t\tfor (var i = 0; i < cw.sambaads.players.length; i++) { \n\t\t\t\tif(cw.sambaads.players[i].id == iframeId){\n\t\t\t\t\treturn cw.sambaads.players[i];\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\t};\n\n\t//parse querystring paramenters from url\n\tvar parseQueryString = function( url ) {\n\n\t\tvar queryString = url.split(\"?\")[1];\n\t\tvar params = {}, queries, temp, i, l;\n\n\t\t// Split into key/value pairs\n\t\ttry{\n\t\t\tqueries = queryString.split(\"&\");\n\n\t\t\t// Convert the array of strings into an object\n\t\t\tfor ( i = 0, l = queries.length; i < l; i++ ) {\n\t\t\t\ttemp = queries[i].split('=');\n\t\t\t\tparams[temp[0]] = temp[1];\n\t\t\t}\n\t\t} catch (e){\n\t\t\t//console.log(e);\n\t\t}\n\n\t\treturn params;\n\t};\n\n\tvar serialize = function(obj) {\n\t  \tvar str = [];\n\t  \tfor(var p in obj){\n\t    \tif (obj.hasOwnProperty(p)) {\n\t      \t\tstr.push(encodeURIComponent(p) + \"=\" + (obj[p] || \"\"));\n\t    \t}\n\t\t}\n\t  \treturn str.join(\"&\");\n\t}\n\n\tvar insertAfter = function (referenceNode, newNode) {\n    \treferenceNode.parentElement.insertBefore(newNode, referenceNode.nextSibling);\n    \t//referenceNode.parentElement.removeChild(referenceNode);\n\t};\n\n\tvar appendIframe = function(parameters){\n\t\tvar div = document.createElement('div');\n\t\tvar iframe_id = \"sambaads_\" + cw.sambaads.players.length;\n\t\tvar iframe_url = \"\";\n\t\tvar width_height = \"\";\n\n\t\tparameters.rfr = encodeURIComponent(window.location.href);\n\n\t\t//se não conseguir obter ao menos o publisher ID não deve renderizar o iframe\n\t\tif(!parameters.p)\n\t\t\treturn;\n\t\t\n\t\tiframe_url = \"//\" + parameters.request_domain + \"/widget/\" + parameters.p + \"?\" + serialize(parameters);\n\n\t\tif(parameters.w){\n\t\t\twidth_height = \"width=\\\"\" + parameters.w + \"\\\" \";\n\t\t}\n\n\t\tif(parameters.h){\n\t\t\twidth_height = width_height + \"height=\\\"\" + parameters.h + \"\\\" \";\n\t\t}\n\n\t\t//generate iframe embed\n\t\tdiv.innerHTML = \"<iframe id=\\\"\" + iframe_id + \"\\\" \" + width_height + \"src=\\\"\" + iframe_url + \"#\" + iframe_id +\"\\\" frameborder=\\\"0\\\" scrolling=\\\"no\\\"  webkitallowfullscreen mozallowfullscreen allowFullScreen></iframe>\";\n\n\t\t//Put iframe after de <script> tag\n\t\tinsertAfter(currentScript, div.firstChild);\n\n\t\tvar iframe_data = {\n\t\t\tid : iframe_id,\n\t\t\tpid : parameters.p || parameters.pid || \"\",\n\t\t\tmid : parameters.m || parameters.mid || \"\",\n\t\t\tcid : parameters.c || parameters.cid || \"\",\n\t\t\tplw : parameters.plw || 0,\n\t\t\tplh : parameters.plh || 0,\n\t\t\tdimension : parameters.d || parameters.dimension,\n\t\t\twidth: parameters.w,\n\t\t\theight: parameters.h,\n\t\t\tiframe_target_host: cw.location.protocol + \"//\" + parameters.request_domain,\n\t\t\ttoClearTimeout: 0,\n\t\t\tisReady: false,\n\t\t\tcontentWindow: function(){\n\t\t\t\treturn document.getElementById(this.id).contentWindow;\n\t\t\t},\n\t\t\tsendMessage: function(smbevent,data){\n\t\t\t\tif(this.contentWindow().postMessage){\n\t\t\t\t\tthis.contentWindow().postMessage( this.id + \"::\" + smbevent + \"::\" + data, this.iframe_target_host )\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t//get the iframeId controled by this script\n\t\tcurrentIframe = iframe_data;\n\n\t\t//store all player embeded on the same page\n\t\tcw.sambaads.players.push(iframe_data);\n\n\t\treturn iframe_data;\n\t};\n\n\tvar init = function(){\t\t\n\t\t//initialize parameters\n\t\tvar parameters = parseQueryString(currentScript.src);\t\n\n\t\tparameters.w = parameters.w ? parameters.w : \"100%\";\n\t\tparameters.h = parameters.h ? parameters.h : \"100%\";\n\t\tparameters.request_domain = '/* @echo CDN_DOMAIN */';\n\n\t\t//append the iframe player\n\t\tvar iframe_data = appendIframe(parameters);\n\n\t\t//initializing the crossdomain message support\n\t\tcrossMessageInitialization(iframe_data);\n\t};\n\n\tvar onMessageReceive = function(event){\n\t\tif(event.origin.indexOf(\"cloudfront\") >= 0 || event.origin.indexOf('/* @echo CDN_DOMAIN */') >= 0){\n\n\t\t\tvar params = event.data.split(\"::\");\n\n\t\t\tif(params[0] == currentIframe.id){\n\t\t\t\t//console.log(\"CORE RECEIVED:\" + event.data)\n\n\t\t\t\tif (params[1] == \"ready\" ){\n\t\t  \t\t\tclearInterval(currentIframe.isReady);\n\t\t  \t\t\tcurrentIframe.isReady = true;\n\t\t  \t\t\tcurrentIframe.player_width = params[2].split(\",\")[1];\n\t\t  \t\t\tcurrentIframe.player_height = params[2].split(\",\")[2] - 4; //- 4 pixels ajust\n\t\t  \t\t\tinitializePluginsAfeterReady();\n\t\t \t\t}\n\n\t\t \t\tif (params[1] == \"click\" ){\n\t\t \t\t\tvar modal = new SambaadsModal();\n\t\t \t\t\tmodal.open(JSON.parse(params[2]));\n\t\t \t\t}\n\n\t\t\t}\n\t\t}\n\t};\n\n\tvar crossMessageInitialization = function(){\n\t\tif (cw.addEventListener){\n\t\t\tcw.addEventListener(\"message\", onMessageReceive, false)\n\t\t} else {\n\t\t\tattachEvent(\"onmessage\", onMessageReceive)\n\t\t};\n\t\t\n\t\tcurrentIframe.isReady = setInterval(function(){\n\t\t\tcurrentIframe.sendMessage(\"ready\",\"\")\n\t\t},2000)\n\t}\n\n\tinit();\n","function SambaadsModal(){};\n\nSambaadsModal.prototype.createElementPlayer = function(arguments){\n\tvar modal = document.getElementsByClassName(\"sambaads-modal-body\")[0];\n\t\n\tvar divMaster = document.createElement('div');\n\tvar w = window.innerWidth || document.documentElement.clientWidth || document.body.clientWidth;\n\tvar h = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n\tdivMaster.style.position = \"absolute\";\n\tdivMaster.id = \"div-master\";\n\tmodal.appendChild(divMaster);\n\n\tvar divChildren = document.createElement('div');\n\tdivChildren.style.backgroundColor = \"#fff\";\n\tdivChildren.style.padding = \"13px\";\n\tdivMaster.appendChild(divChildren);\n\n\tvar divScript = document.createElement('div');\n\tdivScript.style.height = \"360px\";\n\tdivScript.style.width = \"640px\";\n\n\tvar script = document.createElement('script');\n\tscript.type= 'text/javascript';\n\tscript.src= '/javascripts/player.js?m=' + arguments.mediaId + '&p=' + arguments.publisherId + '&sk=blue&tm=light&tb=&tbbg=&w=640&h=360&debug=true';\n\tdivScript.appendChild(script);\n\n\tdivChildren.appendChild(divScript);\n\n\tvar divContext = document.createElement('div');\n\tdivContext.style.width = \"640px\";\n\n\tvar divTitle = document.createElement('div');\n\tdivTitle.textContent = arguments.title;\n\tdivTitle.style.fontSize = \"1.5em\";\n\tdivTitle.style.color = \"#000\";\n\tdivTitle.style.fontFamily = \"helvetica,sans-serif\";\n\tdivTitle.style.fontWeight = \"bold\";\n\tdivTitle.style.textAlign = \"left\";\n\tdivTitle.style.margin = \"10px 10px\";\n\tdivContext.appendChild(divTitle);\n\n\tvar divDescription = document.createElement('div');\n\tdivDescription.textContent = arguments.description;\n  divDescription.style.fontSize = \"0.99em\";\n  divDescription.style.color = \"#000\";\n  divDescription.style.margin = \"0 10px\";\n  divDescription.style.fontFamily = \"helvetica,sans-serif\";\n  divDescription.style.textAlign = \"justify\";\n\tdivContext.appendChild(divDescription);\n\n\tvar divTags = document.createElement('div');\n\tdivTags.style.fontSize = \"0.8em\";\n\tdivTags.style.fontWeight = \"bold\";\n\tdivTags.style.margin = \"10px 0 0px 10px\";\n\tdivTags.style.textAlign = \"left\";\n\tdivTags.textContent = arguments.tagList;\n\tdivContext.appendChild(divTags);\n\n\tdivChildren.appendChild(divContext);\n\n\tdivMaster.style.top = (h - divMaster.clientHeight)/2 + \"px\";\n\tdivMaster.style.left = (w - divMaster.clientWidth)/2 + \"px\";\n};\n\nSambaadsModal.prototype.defineStylePage = function(div){\n\tvar body = document.getElementsByTagName(\"body\")[0];\n\n\tdiv.className = \"sambaads-modal-body\";\n\tdiv.style.position = \"fixed\";\n\tdiv.style.top = \"0\";\n\tdiv.style.right = \"0\";\n\tdiv.style.bottom = \"0\";\n\tdiv.style.left = \"0\";\n\tdiv.style.zIndex = \"99999999\";\n\tdiv.style.backgroundColor = \"rgba(0, 0, 0, 0.9)\";\n\tdiv.style.textAlign = \"center\";\n\tdiv.style.overflow = \"auto\";\n\n\tbody.appendChild(div);\n};\n\nSambaadsModal.prototype.open = function(arguments){\n\tvar div = document.createElement('div');\n\tthis.createListeners(div);\n\tthis.defineStylePage(div);\n\tthis.createElementPlayer(arguments);\n};\n\nSambaadsModal.prototype.close = function(){\n\tvar body = document.getElementsByTagName(\"body\")[0];\n\tvar modal = document.getElementsByClassName(\"sambaads-modal-body\")[0];\n\tbody.removeChild(modal);\n};\n\n\nSambaadsModal.prototype.createListeners = function(element){\n\tvar self = this;\n\telement.onclick = function(){\n\t\tself.close();\n\t}\n};\n\ncw.sambaads.SambaadsModal = SambaadsModal;"],"sourceRoot":"/source/"}